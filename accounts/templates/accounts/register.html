{% load crispy_forms_tags %}
{% load staticfiles %}
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" />
    <link href='https://fonts.googleapis.com/css?family=Satisfy' rel='stylesheet' type='text/css' />
    <link rel="stylesheet" type="text/css" href="{% static 'accounts/css/landing-page.css' %}" />
    <link rel="stylesheet" type="text/css" href="{% static 'accounts/css/bootstrap.min.css' %}" />
    <link rel="stylesheet" type="text/css" href="{% static 'accounts/css/style.css' %}" />
    <link rel="stylesheet" type="text/css" href="{% static 'accounts/css/spinkit.css' %}" />
    <script type="text/javascript" src="{% static 'accounts/js/jquery-3.1.1.min.js' %}"></script>

    <script href="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
    <script href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

{% block body %}
<body class="nav-md">
<div >

        <!-- Navigation -->
        <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="{% url 'accounts:landing'  %}">Mwananchi</a>
            </div>
            <!-- Top Menu Items -->
        </nav>
</div>



<div class="sk-cube-grid" id="sk-cube-grid" style='display:none; margin: 0; position: absolute; top: 50%; left: 50%; margin-right: -50%; transform: translate(-50%, -50%)'>
    <div class="sk-cube sk-cube1"></div>
    <div class="sk-cube sk-cube2"></div>
    <div class="sk-cube sk-cube3"></div>
    <div class="sk-cube sk-cube4"></div>
    <div class="sk-cube sk-cube5"></div>
    <div class="sk-cube sk-cube6"></div>
    <div class="sk-cube sk-cube7"></div>
    <div class="sk-cube sk-cube8"></div>
    <div class="sk-cube sk-cube9"></div>
</div>

<div id="page-wrapper" style="padding-top: 10%">
<div class="container body">
    <div class="row">
        <div class="col-sm-6 col-sm-offset-3 col-md-4 col-md-offset-4">
            <div class="layout-content-body" id="form_body">
                <div class="title-bar">
                    <h2 class="title-bar-title">
                        <span class="d-ib">{{ title }}</span>
                    </h2>
                </div>
                <div class="panel-default" >

                        <div id='loadingmessage' style='display:none'>
                            <p>Loading, plaese wait.....</p>
                        </div>



                        {% if error_message %}
                            <p><strong>{{ error_message }}</strong></p>
                        {% endif %}

                        <form action=" " method="post" enctype="multipart/form-data" class="uniForm" id="form_data">

                            {% csrf_token %}
                            {{ form | crispy }}
                            <div class="form-group">
                                <button type="submit" class="btn btn-primary btn-block" value="{{ title }}">{{ title }}</button>
                            </div>

                        </form>

                </div>
            </div>
        </div>
    </div>
</div>
</div>

<script type="text/javascript">

    $(document).on('submit', '#form_data', function (e){

        e.preventDefault();
        $('#sk-cube-grid').show();
        $('#form_body').hide();
        $.ajax({
            type:'POST',
            url:'/register/',
            data:{
                username:$('#id_username').val(),
                email:$('#id_email').val(),
                password:$('#id_password').val(),
                password2:$('#id_password2').val(),
                csrfmiddlewaretoken:$('input[name=csrfmiddlewaretoken]').val()
            },

            success:function (response) {

                window.location = response;
                $('#sk-cube-grid').hide();


            },
            error:function () {

                alert("Problem");


            }
        });

    });

</script>

</body>
{% endblock %}